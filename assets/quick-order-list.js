customElements.get("quick-order-list-remove-button")||customElements.define("quick-order-list-remove-button",class extends HTMLElement{constructor(){super(),this.addEventListener("click",t=>{t.preventDefault(),this.closest("quick-order-list").updateQuantity(this.dataset.index,0)})}}),customElements.get("quick-order-list-remove-all-button")||customElements.define("quick-order-list-remove-all-button",class extends HTMLElement{constructor(){super(),this.quickOrderList=this.closest("quick-order-list");var t=this.quickOrderList.querySelectorAll("[data-quantity-variant-id]");const e={};let i=!1;t.forEach(t=>{0<parseInt(t.dataset.cartQuantity)&&(i=!0,e[parseInt(t.dataset.quantityVariantId)]=0)}),i||this.classList.add("hidden"),this.actions={confirm:"confirm",remove:"remove",cancel:"cancel"},this.addEventListener("click",t=>{t.preventDefault(),this.dataset.action===this.actions.confirm?this.toggleConfirmation(!1,!0):this.dataset.action===this.actions.remove?(this.quickOrderList.updateMultipleQty(e),this.toggleConfirmation(!0,!1)):this.dataset.action===this.actions.cancel&&this.toggleConfirmation(!0,!1)})}toggleConfirmation(t,e){this.quickOrderList.querySelector(".quick-order-list-total__confirmation").classList.toggle("hidden",t),this.quickOrderList.querySelector(".quick-order-list-total__info").classList.toggle("hidden",e)}}),customElements.get("quick-order-list")||customElements.define("quick-order-list",class extends HTMLElement{constructor(){super(),this.cart=document.querySelector("cart-drawer"),this.actions={add:"ADD",update:"UPDATE"},this.quickOrderListId="quick-order-list-"+this.dataset.productId,this.defineInputsAndQuickOrderTable(),this.variantItemStatusElement=document.getElementById("shopping-cart-variant-item-status");var t=this.querySelector("form"),e=(this.inputFieldHeight=this.querySelector(".variant-item__quantity-wrapper").offsetHeight,this.isListInsideModal=document.querySelector(".quick-add-bulk"),this.stickyHeaderElement=document.querySelector("sticky-header"),this.getTableHead(),this.getTotalBar(),this.stickyHeaderElement&&(this.stickyHeader={height:this.stickyHeaderElement.offsetHeight,type:""+this.stickyHeaderElement.getAttribute("data-sticky-type")}),this.getTotalBar()&&(this.totalBarPosition=window.innerHeight-this.getTotalBar().offsetHeight,window.addEventListener("resize",()=>{this.totalBarPosition=window.innerHeight-this.getTotalBar().offsetHeight,this.stickyHeader.height=this.stickyHeaderElement?this.stickyHeaderElement.offsetHeight:0})),new URLSearchParams(window.location.search));window.pageNumber=decodeURIComponent(e.get("page")||""),t.addEventListener("submit",this.onSubmit.bind(this)),this.addMultipleDebounce()}cartUpdateUnsubscriber=void 0;onSubmit(t){t.preventDefault()}connectedCallback(){this.cartUpdateUnsubscriber=subscribe(PUB_SUB_EVENTS.cartUpdate,t=>{t.source!==this.quickOrderListId&&this.refresh().then(()=>{this.defineInputsAndQuickOrderTable(),this.addMultipleDebounce()})}),this.sectionId=this.dataset.id}disconnectedCallback(){this.cartUpdateUnsubscriber?.()}defineInputsAndQuickOrderTable(){this.allInputsArray=Array.from(this.querySelectorAll('input[type="number"]')),this.quickOrderListTable=this.querySelector(".quick-order-list__table"),this.quickOrderListTable.addEventListener("focusin",this.switchVariants.bind(this))}onChange(t){var e=parseInt(t.target.value),i=parseInt(t.target.dataset.cartQuantity),r=t.target.dataset.index,s=document.activeElement.getAttribute("name"),a=e-i;this.cleanErrorMessageOnType(t),0==e?this.updateQuantity(r,e,s,this.actions.update):this.validateQuantity(t,s,r,e,i,a)}cleanErrorMessageOnType(t){t.target.addEventListener("keydown",()=>{t.target.setCustomValidity(" "),t.target.reportValidity()})}validateQuantity(t,e,i,r,s,a){r<t.target.dataset.min?this.setValidity(t,i,window.quickOrderListStrings.min_error.replace("[min]",t.target.dataset.min)):r>parseInt(t.target.max)?this.setValidity(t,i,window.quickOrderListStrings.max_error.replace("[max]",t.target.max)):r%parseInt(t.target.step)!=0?this.setValidity(t,i,window.quickOrderListStrings.step_error.replace("[step]",t.target.step)):(t.target.setCustomValidity(""),t.target.reportValidity(),0<s?this.updateQuantity(i,r,e,this.actions.update):this.updateQuantity(i,a,e,this.actions.add))}setValidity(t,e,i){t.target.setCustomValidity(i),t.target.reportValidity(),this.resetQuantityInput(e),t.target.select()}validateInput(t){return t.max?0==parseInt(t.value)||parseInt(t.value)>=parseInt(t.dataset.min)&&parseInt(t.value)<=parseInt(t.max)&&parseInt(t.value)%parseInt(t.step)==0:0==parseInt(t.value)||parseInt(t.value)>=parseInt(t.dataset.min)&&parseInt(t.value)%parseInt(t.step)==0}refresh(){return new Promise((e,i)=>{fetch(this.getSectionsUrl()+"?section_id="+this.sectionId).then(t=>t.text()).then(t=>{t=(new DOMParser).parseFromString(t,"text/html").querySelector("#"+this.quickOrderListId);t&&(this.innerHTML=t.innerHTML),e()}).catch(t=>{console.error(t),i(t)})})}getSectionsToRender(){return[{id:this.quickOrderListId,section:document.getElementById(this.quickOrderListId).dataset.id,selector:`#${this.quickOrderListId} .js-contents`},{id:"cart-icon-bubble",section:"cart-icon-bubble",selector:".shopify-section"},{id:"quick-order-list-live-region-text-"+this.dataset.productId,section:"cart-live-region-text",selector:".shopify-section"},{id:"quick-order-list-total-"+this.dataset.productId,section:document.getElementById(this.quickOrderListId).dataset.id,selector:`#${this.quickOrderListId} .quick-order-list__total`},{id:"CartDrawer",selector:"#CartDrawer",section:"cart-drawer"}]}addMultipleDebounce(){this.querySelectorAll("quantity-input").forEach(t=>{var e=debounce(t=>{this.onChange(t)},ON_CHANGE_DEBOUNCE_TIMER);t.addEventListener("change",e.bind(this))})}addDebounce(t){var t=this.querySelector(`#Variant-${t} quantity-input`),e=debounce(t=>{this.onChange(t)},ON_CHANGE_DEBOUNCE_TIMER);t.addEventListener("change",e.bind(this))}renderSections(i,r){this.getSectionsToRender().forEach(t=>{var e=document.getElementById(t.id),e=(e&&e.parentElement&&e.parentElement.classList.contains("drawer")&&(0<i.items.length?e.parentElement.classList.remove("is-empty"):e.parentElement.classList.add("is-empty"),setTimeout(()=>{document.querySelector("#CartDrawer-Overlay").addEventListener("click",this.cart.close.bind(this.cart))})),e&&e.querySelector(t.selector)?e.querySelector(t.selector):e);e&&(t.selector===`#${this.quickOrderListId} .js-contents`&&void 0!==r?e.querySelector("#Variant-"+r).innerHTML=this.getSectionInnerHTML(i.sections[t.section],"#Variant-"+r):e.innerHTML=this.getSectionInnerHTML(i.sections[t.section],t.selector))}),this.defineInputsAndQuickOrderTable(),r?this.addDebounce(r):this.addMultipleDebounce()}getTableHead(){return document.querySelector(".quick-order-list__table thead")}getTotalBar(){return this.querySelector(".quick-order-list__total")}scrollQuickOrderListTable(){var t,e,i,r=this.variantListInput.getBoundingClientRect().top,s=this.variantListInput.getBoundingClientRect().bottom;this.isListInsideModal?(t=s>this.getTotalBar().getBoundingClientRect().top,e=r<this.getTableHead().getBoundingClientRect().bottom,(t||e)&&this.scrollToCenter()):(t=this.stickyHeaderElement&&this.stickyHeaderElement.getBoundingClientRect().bottom,e=s>this.totalBarPosition,s=s<this.inputFieldHeight,i=this.stickyHeaderElement&&"on-scroll-up"!==this.stickyHeader.type&&this.stickyHeader.height>r,r=this.stickyHeaderElement&&"on-scroll-up"===this.stickyHeader.type&&this.stickyHeader.height>r&&0<t,(e||s||i||r)&&this.scrollToCenter())}scrollToCenter(){this.variantListInput.scrollIntoView({block:"center",behavior:"smooth"})}switchVariants(t){"INPUT"===t.target.tagName&&(this.variantListInput=t.target,this.variantListInput.select(),1!==this.allInputsArray.length?(this.variantListInput.addEventListener("keydown",t=>{var e;"Enter"===t.key&&(t.preventDefault(),t.target.blur(),this.validateInput(t.target))&&(e=this.allInputsArray.indexOf(t.target),this.lastKey=t.shiftKey,(t.shiftKey?(t=this.allInputsArray[e-1]||this.allInputsArray[this.allInputsArray.length-1],this.lastElement=t.dataset.index,t):this.allInputsArray[e+1]||this.allInputsArray[0]).select())}),this.scrollQuickOrderListTable()):this.variantListInput.addEventListener("keydown",t=>{"Enter"===t.key&&(t.preventDefault(),t.target.blur())}))}updateMultipleQty(t){this.querySelector(".variant-remove-total .loading__spinner").classList.remove("hidden");t=JSON.stringify({updates:t,sections:this.getSectionsToRender().map(t=>t.section),sections_url:this.getSectionsUrl()});this.updateMessage(),this.setErrorMessage(),fetch(""+routes.cart_update_url,{...fetchConfig(),body:t}).then(t=>t.text()).then(t=>{t=JSON.parse(t);this.renderSections(t)}).catch(()=>{this.setErrorMessage(window.cartStrings.error)}).finally(()=>{this.querySelector(".variant-remove-total .loading__spinner").classList.add("hidden")})}getSectionsUrl(){return window.pageNumber?window.location.pathname+"?page="+window.pageNumber:""+window.location.pathname}updateQuantity(s,a,t,n){this.toggleLoading(s,!0),this.cleanErrors();let e=routes.cart_change_url,i=JSON.stringify({quantity:a,id:s,sections:this.getSectionsToRender().map(t=>t.section),sections_url:this.getSectionsUrl()}),r;n===this.actions.add&&(r="javascript",e=routes.cart_add_url,i=JSON.stringify({items:[{quantity:parseInt(a),id:parseInt(s)}],sections:this.getSectionsToRender().map(t=>t.section),sections_url:this.getSectionsUrl()})),this.updateMessage(),this.setErrorMessage(),fetch(""+e,{...fetchConfig(r),body:i}).then(t=>t.text()).then(e=>{var e=JSON.parse(e),i=document.getElementById("Quantity-"+s);document.querySelectorAll(".variant-item");if(e.description||e.errors)document.querySelector(`[id^="Variant-${s}"] .variant-item__totals.small-hide .loading__spinner`).classList.add("loading__spinner--error"),this.resetQuantityInput(s,i),e.errors?this.updateLiveRegions(s,e.errors):this.updateLiveRegions(s,e.description);else{this.classList.toggle("is-empty",0===e.item_count),this.renderSections(e,s);let t=!1;var r=e.items.find(t=>t.variant_id===parseInt(s)),r=r?r.quantity:void 0;r&&r!==a&&(this.updateError(r,s),t=!0),publish(PUB_SUB_EVENTS.cartUpdate,{source:this.quickOrderListId,cartData:e}),t?this.updateMessage():n===this.actions.add?this.updateMessage(parseInt(a)):n===this.actions.update?this.updateMessage(parseInt(a-i.dataset.cartQuantity)):this.updateMessage(-parseInt(i.dataset.cartQuantity))}}).catch(t=>{this.querySelectorAll(".loading__spinner").forEach(t=>t.classList.add("hidden")),this.resetQuantityInput(s),console.error(t),this.setErrorMessage(window.cartStrings.error)}).finally(()=>{this.toggleLoading(s),this.lastKey&&this.lastElement===s&&this.querySelector(`#Variant-${s} input`).select()})}resetQuantityInput(t,e){e=e??document.getElementById("Quantity-"+t);e.value=e.getAttribute("value")}setErrorMessage(i=null){this.errorMessageTemplate=this.errorMessageTemplate??document.getElementById("QuickOrderListErrorTemplate-"+this.dataset.productId).cloneNode(!0),document.querySelectorAll(".quick-order-list-error").forEach(t=>{var e;t.innerHTML="",i&&((e=this.errorMessageTemplate.cloneNode(!0)).content.querySelector(".quick-order-list-error-message").innerText=i,t.appendChild(e.content))})}updateMessage(t=null){var e=this.querySelectorAll(".quick-order-list__message-text"),i=this.querySelectorAll(".quick-order-list__message-icon");if(null===t||isNaN(t))e.forEach(t=>t.innerHTML=""),i.forEach(t=>t.classList.add("hidden"));else{var r=t<0;const s=Math.abs(t),a=r?1===s?window.quickOrderListStrings.itemRemoved:window.quickOrderListStrings.itemsRemoved:1===t?window.quickOrderListStrings.itemAdded:window.quickOrderListStrings.itemsAdded;e.forEach(t=>t.innerHTML=a.replace("[quantity]",s)),r||i.forEach(t=>t.classList.remove("hidden"))}}updateError(t,e){let i="";i=void 0===t?window.cartStrings.error:window.cartStrings.quantityError.replace("[quantity]",t),this.updateLiveRegions(e,i)}cleanErrors(){this.querySelectorAll(".desktop-row-error").forEach(t=>t.classList.add("hidden")),this.querySelectorAll(".variant-item__error-text").forEach(t=>t.innerHTML="")}updateLiveRegions(t,e){var i=document.getElementById("Quick-order-list-item-error-desktop-"+t),t=document.getElementById("Quick-order-list-item-error-mobile-"+t);i&&(i.querySelector(".variant-item__error-text").innerHTML=e,i.closest("tr").classList.remove("hidden")),t&&(t.querySelector(".variant-item__error-text").innerHTML=e),this.variantItemStatusElement.setAttribute("aria-hidden",!0);const r=document.getElementById("quick-order-list-live-region-text");r.setAttribute("aria-hidden",!1),setTimeout(()=>{r.setAttribute("aria-hidden",!0)},1e3)}getSectionInnerHTML(t,e){return(new DOMParser).parseFromString(t,"text/html").querySelector(e).innerHTML}toggleLoading(t,e){var i=this.querySelectorAll(`#Variant-${t} .loading__spinner`),t=this.querySelector("#Variant-"+t);e?(t.classList.add("quick-order-list__container--disabled"),[...i].forEach(t=>t.classList.remove("hidden")),this.variantItemStatusElement.setAttribute("aria-hidden",!1)):(t.classList.remove("quick-order-list__container--disabled"),i.forEach(t=>t.classList.add("hidden")))}});